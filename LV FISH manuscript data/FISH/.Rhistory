paste('Object_coordinates-', Sys.Date(), '.csv', sep='')
},
content <- function(file) {
write.csv(rdaSol()$CA$u, file)
},
contentType = 'text/csv'
)
# Download variable coordinates
output$downloadData.variableCoordinates <- downloadHandler(
filename <- function() {
paste('Variable_coordinates-', Sys.Date(), '.csv', sep='')
},
content <- function(file) {
write.csv(rdaSol()$CA$v, file)
},
contentType = 'text/csv'
)
} # End shiny server
#)
shinyApp(ui, server)
data(mite)
# here data need to be in .cvs format, the seperator is a ; and the decimal seperator is a ,
# Community data submission
comm <<- read.csv(file.choose(), header = TRUE, sep=",", row.names = 1, dec = ".")
# here data need to be in .cvs format, the seperator is a ; and the decimal seperator is a ,
# Community data submission
comm <<- read.csv(file.choose(), header = TRUE, sep=",", row.names = 1, dec = ".")
# Community data submission
comm <<- read.csv(file.choose(), header = TRUE, sep=",", row.names = 1, dec = ".")
# Community data submission
comm <<- read.csv(file.choose(), header = TRUE, sep=",", row.names = 1, dec = ".")
install.packages("cli")
install.packages("cli")
setwd("D:/sarah/Documents/Dropbox/GitHub Repositories/EN638-Atlantic-Endeavor-Cruise-2019/LV FISH manuscript data/FISH")
library("plyr")
library("ggplot2")
library("scales")
library("dplyr")
library("ggh4x")
library("patchwork")
library("tidyverse")
library("grafify")
#devtools::install_github("teunbrand/ggh4x")
#Graphing cell counts
FISH <- read.csv("EN638_bulk_LV_FISH.csv")
#Calculating percent of selfish bacteria labeled as each probe
FISH_percent <- FISH %>%
group_by(stn, amendment_type, depth_name, substrate, time_d, FISH_probe, cells_ml, substratecells_ml, dapifish_ml, dapifishsubstrate_ml) %>%
summarise(percentmean = (dapifishsubstrate_ml/substratecells_ml)*100)
#Ordering Factors
FISH_percent$stn <- factor(FISH_percent$stn, levels = c("stn18","stn19", "stn20"), labels=c("Station 18", "Station 19", "Station 20"))
FISH_percent$amendment_type <- factor(FISH_percent$amendment_type, levels = c("unamend","amend"), labels=c("Unamended", "Amended"))
FISH_percent$FISH_probe <- factor(FISH_percent$FISH_probe, levels = c("EUB1", "CF319a", "PLA46", "GAM42a", "EUB3"))
#Subsets
Amend <- subset(FISH_percent, amendment_type=="Amended")
Unamend <- subset(FISH_percent, amendment_type=="Unamended")
#Ordering factors (time_d) and changing them to the correct times (for Unamended mesocosms)
Unamend$time_d <- factor(Unamend$time_d, levels = c("0.2", "1", "2", "3", "7", "10"), labels=c("0", "1", "1", "3", "7", "10"))
Unamend$depth_name <- factor(Unamend$depth_name, levels = c("DCM", "bottom"), labels=c("DCM", "Bottom"))
#Ordering factors (time_d) for the Amended mesocosms and renaming them to be the time since water collection so that they are on the same time frame as the Unamended
Amend$time_d <- factor(Amend$time_d, levels = c("0", "3", "5", "10", "15"), labels = c("2", "5", "7", "12", "17"))
Amend$depth_name <- factor(Amend$depth_name, levels = c("dA", "dC"), labels=c("DCM", "Bottom"))
#Number of selfish bacteria labeled as each probe; stacked bars
#Remove EUB1
Unamend_forgraph <- filter(Unamend, FISH_probe != "EUB1")
Amend_forgraph <- filter(Amend, FISH_probe != "EUB1")
#Subsets
Unamend_forgraph_DCM <- subset(Unamend_forgraph, depth_name=="DCM")
Unamend_forgraph_Bottom <- subset(Unamend_forgraph, depth_name=="Bottom")
Amend_forgraph_DCM <- subset(Amend_forgraph, depth_name=="DCM")
Amend_forgraph_Bottom <- subset(Amend_forgraph, depth_name=="Bottom")
#Grafify colorblind-friendly hex codes for the following graphs: ok_yellow #F0E442, kelly_7 #848482, ok_orange #E69F00, ok_bluegreen #009E73 or dark_cyan #225555
#Graph unamended DCM
Unamend_DCM_FISH_plot <-ggplot(Unamend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 50000, 100000, 150000, 200000), limits=c(0, 200000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_blank(),
axis.text.y = element_text(size=9, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_text(size=10),
axis.ticks.x = element_blank(), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=10, color="black"))
print(Unamend_DCM_FISH_plot)
#Graph unamended Bottom
Unamend_Bottom_FISH_plot <-ggplot(Unamend_forgraph_Bottom, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 250, 500, 750, 1000), limits=c(0, 1000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=9, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=9, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=10), axis.title.y = element_text(size=10),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text.y = element_text(size=10, color="black"), strip.text.x = element_blank())
print(Unamend_Bottom_FISH_plot)
#Graph amended DCM
Amend_DCM_FISH_plot <-ggplot(Amend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25000, 50000, 75000, 100000, 200000), limits=c(0, 100000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_blank(),
axis.text.y = element_text(size=9, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_text(size=10),
axis.ticks.x = element_blank(), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=10, color="black"), legend.position = "none", strip.text.y = element_blank())
print(Amend_DCM_FISH_plot)
#Graph amended bottom
Amend_Bottom_FISH_plot <-ggplot(Amend_forgraph_Bottom, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 1000, 2000, 3000, 4000, 5000), limits=c(0, 5000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=9, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=9, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=10), axis.title.y = element_text(size=10),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_blank(), legend.position = "none", strip.text.y = element_blank())
print(Amend_Bottom_FISH_plot)
library("patchwork")
#Figure: FISH and lam selfish
FISH_abundance_all <- (Amend_DCM_FISH_plot + Unamend_DCM_FISH_plot) / (Amend_Bottom_FISH_plot + Unamend_Bottom_FISH_plot)
print(FISH_abundance_all)
ggsave(filename="EN638_FISH_selfish_lam_abundance.pdf", plot=FISH_abundance_all, width=8, height=6, device=cairo_pdf)
#Remove EUB1
Unamend_forgraph <- filter(Unamend, FISH_probe != "EUB1")
#Graph unamended DCM
Unamend_DCM_FISH_plot <-ggplot(Unamend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 50000, 100000, 150000, 200000), limits=c(0, 200000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_blank(),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_text(size=12),
axis.ticks.x = element_blank(), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=12, color="black"))
print(Unamend_DCM_FISH_plot)
#Graph unamended Bottom
Unamend_Bottom_FISH_plot <-ggplot(Unamend_forgraph_Bottom, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 250, 500, 750, 1000), limits=c(0, 1000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=11, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=12), axis.title.y = element_text(size=12),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text.y = element_text(size=12, color="black"), strip.text.x = element_blank())
print(Unamend_Bottom_FISH_plot)
#Graph amended DCM
Amend_DCM_FISH_plot <-ggplot(Amend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25000, 50000, 75000, 100000, 200000), limits=c(0, 100000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_blank(),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_text(size=12),
axis.ticks.x = element_blank(), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=12, color="black"), legend.position = "none", strip.text.y = element_blank())
print(Amend_DCM_FISH_plot)
#Graph amended bottom
Amend_Bottom_FISH_plot <-ggplot(Amend_forgraph_Bottom, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 1000, 2000, 3000, 4000, 5000), limits=c(0, 5000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=11, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=12, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=12), axis.title.y = element_text(size=12),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_blank(), legend.position = "none", strip.text.y = element_blank())
print(Amend_Bottom_FISH_plot)
#Combining plots together using patchwork
library("patchwork")
#Figure: FISH and lam selfish
FISH_abundance_all <- (Amend_DCM_FISH_plot + Unamend_DCM_FISH_plot) / (Amend_Bottom_FISH_plot + Unamend_Bottom_FISH_plot)
print(FISH_abundance_all)
ggsave(filename="EN638_FISH_selfish_lam_abundance.pdf", plot=FISH_abundance_all, width=8, height=6, device=cairo_pdf)
ggsave(filename="EN638_FISH_selfish_lam_abundance.pdf", plot=FISH_abundance_all, width=9, height=6, device=cairo_pdf)
ggsave(filename="EN638_FISH_selfish_lam_abundance.pdf", plot=FISH_abundance_all, width=9.5, height=6, device=cairo_pdf)
Amend_DCM_FISH_plot <-ggplot(Amend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25000, 50000, 75000, 100000, 200000), limits=c(0, 100000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=11, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=12), axis.title.y = element_text(size=12),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text.y = element_text(size=12, color="black"), strip.text.x = element_blank())
print(Amend_DCM_FISH_plot)
Amend_Bottom_FISH_plot <-ggplot(Amend_forgraph_Bottom, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 1000, 2000, 3000, 4000, 5000), limits=c(0, 5000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=11, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=12), axis.title.y = element_text(size=12),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text.y = element_text(size=12, color="black"), strip.text.x = element_blank())
print(Amend_Bottom_FISH_plot)
Unamend_DCM_FISH_plot <-ggplot(Unamend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 50000, 100000, 150000, 200000), limits=c(0, 200000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_blank(),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_text(size=12),
axis.ticks.x = element_blank(), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=12, color="black"), legend.position = "none", strip.text.y = element_blank())
print(Unamend_DCM_FISH_plot)
Unamend_Bottom_FISH_plot <-ggplot(Unamend_forgraph_Bottom, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 250, 500, 750, 1000), limits=c(0, 1000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_blank(),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_text(size=12),
axis.ticks.x = element_blank(), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=12, color="black"), legend.position = "none", strip.text.y = element_blank())
print(Unamend_Bottom_FISH_plot)
Unamend_DCM_FISH_plot <-ggplot(Unamend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 50000, 100000, 150000, 200000), limits=c(0, 200000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_blank(),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_text(size=12),
axis.ticks.x = element_blank(), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=12, color="black"), legend.position = "none", strip.text.y = element_blank())
print(Unamend_DCM_FISH_plot)
Unamend_Bottom_FISH_plot <-ggplot(Unamend_forgraph_Bottom, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 250, 500, 750, 1000), limits=c(0, 1000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=11, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=12, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=12), axis.title.y = element_text(size=12),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_blank(), legend.position = "none", strip.text.y = element_blank())
print(Unamend_Bottom_FISH_plot)
Amend_DCM_FISH_plot <-ggplot(Amend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25000, 50000, 75000, 100000, 200000), limits=c(0, 100000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=11, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=12), axis.title.y = element_text(size=12),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text.y = element_text(size=12, color="black"), strip.text.x = element_blank())
print(Amend_DCM_FISH_plot)
Amend_DCM_FISH_plot <-ggplot(Amend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25000, 50000, 75000, 100000, 200000), limits=c(0, 100000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_blank(),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_text(size=12),
axis.ticks.x = element_blank(), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=12, color="black"))
print(Amend_DCM_FISH_plot)
Amend_Bottom_FISH_plot <-ggplot(Amend_forgraph_Bottom, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 1000, 2000, 3000, 4000, 5000), limits=c(0, 5000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=11, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=12), axis.title.y = element_text(size=12),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text.y = element_text(size=12, color="black"), strip.text.x = element_blank())
print(Amend_Bottom_FISH_plot)
FISH_abundance_all <- (Unamend_DCM_FISH_plot + Amend_DCM_FISH_plot) / (Unamend_Bottom_FISH_plot + Amend_Bottom_FISH_plot)
print(FISH_abundance_all)
#######################################################################################OLD
#Graph unamended DCM
Unamend_DCM_FISH_plot <-ggplot(Unamend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 50000, 100000, 150000, 200000), limits=c(0, 200000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_blank(),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_text(size=12),
axis.ticks.x = element_blank(), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=12, color="black"))
print(Unamend_DCM_FISH_plot)
#Graph unamended Bottom
Unamend_Bottom_FISH_plot <-ggplot(Unamend_forgraph_Bottom, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 250, 500, 750, 1000), limits=c(0, 1000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=11, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=12), axis.title.y = element_text(size=12),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text.y = element_text(size=12, color="black"), strip.text.x = element_blank())
print(Unamend_Bottom_FISH_plot)
#Graph amended DCM
Amend_DCM_FISH_plot <-ggplot(Amend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25000, 50000, 75000, 100000, 200000), limits=c(0, 100000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_blank(),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_text(size=12),
axis.ticks.x = element_blank(), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=12, color="black"), legend.position = "none", strip.text.y = element_blank())
print(Amend_DCM_FISH_plot)
#Graph amended bottom
Amend_Bottom_FISH_plot <-ggplot(Amend_forgraph_Bottom, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 1000, 2000, 3000, 4000, 5000), limits=c(0, 5000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=11, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=12, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=12), axis.title.y = element_text(size=12),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_blank(), legend.position = "none", strip.text.y = element_blank())
print(Amend_Bottom_FISH_plot)
#Graph unamended DCM
Unamend_DCM_FISH_plot <-ggplot(Unamend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 50000, 100000, 150000, 200000), limits=c(0, 200000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_blank(),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_text(size=12),
axis.ticks.x = element_blank(), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=12, color="black"), legend.position = "none", strip.text.y = element_blank())
print(Unamend_DCM_FISH_plot)
#Graph unamended Bottom
Unamend_Bottom_FISH_plot <-ggplot(Unamend_forgraph_Bottom, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 250, 500, 750, 1000), limits=c(0, 1000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=11, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=12, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=12), axis.title.y = element_text(size=12),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_blank(), legend.position = "none", strip.text.y = element_blank())
print(Unamend_Bottom_FISH_plot)
#Graph amended DCM (NEW)
Amend_DCM_FISH_plot <-ggplot(Amend_forgraph_DCM, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25000, 50000, 75000, 100000, 200000), limits=c(0, 100000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_blank(),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank(), axis.title.y = element_text(size=12),
axis.ticks.x = element_blank(), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=12, color="black"))
print(Amend_DCM_FISH_plot)
#Graph amended bottom (NEW)
Amend_Bottom_FISH_plot <-ggplot(Amend_forgraph_Bottom, aes(x=time_d, y=dapifishsubstrate_ml, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 1000, 2000, 3000, 4000, 5000), limits=c(0, 5000), labels = scientific)+
facet_grid(depth_name ~ stn)+labs(x="Time (days)", y=("Selfish cellular abundance (cells/mL)"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=11, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=11, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=12), axis.title.y = element_text(size=12),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text.y = element_text(size=12, color="black"), strip.text.x = element_blank())
print(Amend_Bottom_FISH_plot)
#Combining plots together using patchwork
library("patchwork")
#Figure: FISH and lam selfish
FISH_abundance_all <- (Unamend_DCM_FISH_plot + Amend_DCM_FISH_plot) / (Unamend_Bottom_FISH_plot + Amend_Bottom_FISH_plot)
print(FISH_abundance_all)
ggsave(filename="EN638_FISH_selfish_lam_abundance.pdf", plot=FISH_abundance_all, width=9.5, height=6, device=cairo_pdf)
#Percent selfish bacteria labeled as each probe; each probe it's own row of graphs
#In Unamended Mesos
#Remove EUB1
Unamend_forgraph <- filter(Unamend, FISH_probe != "EUB1")
#Subset by depth
Unamend_graph_DCM <- subset(Unamend_forgraph, depth_name=="DCM")
Unamend_graph_Bottom <- subset(Unamend_forgraph, depth_name=="Bottom")
#Graph
Unamend_DCM_FISH_plot <-ggplot(Unamend_graph_DCM, aes(x=time_d, y=percentmean, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25, 50, 75, 100), limits=c(0, 100))+
facet_grid(FISH_probe ~ stn)+labs(x="Time (days)", y=("Percent of all selfish cells"))+
scale_fill_manual(values=c("EUB3" = "springgreen1","GAM42a" = "red","PLA46" = "chocolate","CF319a" = "yellow", "EUB1" ="grey"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=9, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=9, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=10), axis.title.y = element_text(size=10),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=10, color="black"), legend.position = "none")
print(Unamend_DCM_FISH_plot)
Unamend_Bottom_FISH_plot <-ggplot(Unamend_graph_Bottom, aes(x=time_d, y=percentmean, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25, 50, 75, 100), limits=c(0, 100))+
facet_grid(FISH_probe ~ stn)+labs(x="Time (days)", y=("Percent of all selfish cells"))+
scale_fill_manual(values=c("EUB3" = "springgreen1","GAM42a" = "red","PLA46" = "chocolate","CF319a" = "yellow", "EUB1" ="grey"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=9, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=9, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=10), axis.title.y = element_text(size=10),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=10, color="black"), legend.position = "none")
print(Unamend_Bottom_FISH_plot)
#In Amended Mesos
#Remove EUB1
Amend_forgraph <- filter(Amend, FISH_probe != "EUB1")
#Subset by depth
Amend_graph_DCM <- subset(Amend_forgraph, depth_name=="DCM")
Amend_graph_Bottom <- subset(Amend_forgraph, depth_name=="Bottom")
#Graph
Amend_DCM_FISH_plot <-ggplot(Amend_graph_DCM, aes(x=time_d, y=percentmean, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25, 50, 75, 100), limits=c(0, 100))+
facet_grid(FISH_probe ~ stn)+labs(x="Time (days)", y=("Percent of all selfish cells"))+
scale_fill_manual(values=c("EUB3" = "springgreen1","GAM42a" = "red","PLA46" = "chocolate","CF319a" = "yellow", "EUB1" ="grey"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=9, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=9, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=10), axis.title.y = element_text(size=10),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=10, color="black"), legend.position = "none")
print(Amend_DCM_FISH_plot)
Amend_Bottom_FISH_plot <-ggplot(Amend_graph_Bottom, aes(x=time_d, y=percentmean, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25, 50, 75, 100), limits=c(0, 100))+
facet_grid(FISH_probe ~ stn)+labs(x="Time (days)", y=("Percent of all selfish cells"))+
scale_fill_manual(values=c("EUB3" = "springgreen1","GAM42a" = "red","PLA46" = "chocolate","CF319a" = "yellow", "EUB1" ="grey"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=9, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=9, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=10), axis.title.y = element_text(size=10),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=10, color="black"))
print(Amend_Bottom_FISH_plot)
#In Unamended Mesos
#Remove EUB1
Unamend_forgraph <- filter(Unamend, FISH_probe != "EUB1")
#Subset by depth
Unamend_graph_DCM <- subset(Unamend_forgraph, depth_name=="DCM")
Unamend_graph_Bottom <- subset(Unamend_forgraph, depth_name=="Bottom")
#Graph
Unamend_DCM_FISH_plot <-ggplot(Unamend_graph_DCM, aes(x=time_d, y=percentmean, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25, 50, 75, 100), limits=c(0, 100))+
facet_grid(FISH_probe ~ stn)+labs(x="Time (days)", y=("Percent of all selfish cells"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=9, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=9, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=10), axis.title.y = element_text(size=10),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=10, color="black"), legend.position = "none")
print(Unamend_DCM_FISH_plot)
Unamend_Bottom_FISH_plot <-ggplot(Unamend_graph_Bottom, aes(x=time_d, y=percentmean, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25, 50, 75, 100), limits=c(0, 100))+
facet_grid(FISH_probe ~ stn)+labs(x="Time (days)", y=("Percent of all selfish cells"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=9, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=9, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=10), axis.title.y = element_text(size=10),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=10, color="black"), legend.position = "none")
print(Unamend_Bottom_FISH_plot)
#In Amended Mesos
#Remove EUB1
Amend_forgraph <- filter(Amend, FISH_probe != "EUB1")
#Subset by depth
Amend_graph_DCM <- subset(Amend_forgraph, depth_name=="DCM")
Amend_graph_Bottom <- subset(Amend_forgraph, depth_name=="Bottom")
#Graph
Amend_DCM_FISH_plot <-ggplot(Amend_graph_DCM, aes(x=time_d, y=percentmean, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25, 50, 75, 100), limits=c(0, 100))+
facet_grid(FISH_probe ~ stn)+labs(x="Time (days)", y=("Percent of all selfish cells"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=9, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=9, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=10), axis.title.y = element_text(size=10),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=10, color="black"), legend.position = "none")
print(Amend_DCM_FISH_plot)
Amend_Bottom_FISH_plot <-ggplot(Amend_graph_Bottom, aes(x=time_d, y=percentmean, fill=FISH_probe))+ geom_bar(stat="identity", width=1, colour = "black", size=0.2)+
scale_y_continuous(breaks=c(0, 25, 50, 75, 100), limits=c(0, 100))+
facet_grid(FISH_probe ~ stn)+labs(x="Time (days)", y=("Percent of all selfish cells"))+
scale_fill_manual(values=c("EUB3" = "#225555","GAM42a" = "#E69F00","PLA46" = "#848482","CF319a" = "#F0E442"))+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
axis.text.x  = element_text(size=9, colour="black", angle=0, hjust=0.5, vjust=1),
axis.text.y = element_text(size=9, colour="black"), plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=10), axis.title.y = element_text(size=10),
axis.ticks.x = element_line(colour="#000000", size=0.1), axis.ticks.y = element_line(colour="#000000", size=0.1),
strip.text = element_text(size=10, color="black"))
print(Amend_Bottom_FISH_plot)
#Combining plots together for each depth using patchwork
library("patchwork")
#Combine figures
Selfish_FISH_percent_Unamend <- (Unamend_DCM_FISH_plot / Unamend_Bottom_FISH_plot)
Selfish_FISH_percent_Amend <- (Amend_DCM_FISH_plot / Amend_Bottom_FISH_plot)
Combined <- Selfish_FISH_percent_Unamend | Selfish_FISH_percent_Amend
print(Combined)
ggsave(filename="EN638_selfish_FISH_all_percent.pdf", plot=Combined, width=10, height=8, device=cairo_pdf)
